#-------------------------------
# Web browsers
#-------------------------------
ext x?html?, has qutebrowser, X, flag f = qutebrowser -- "$@"
ext x?html?, has firefox, X, flag f = firefox -- "$@"
ext x?html?, has floorp, X, flag f = floorp -- "$@"
ext x?html?, has w3m, terminal = w3m "$@"
ext x?html?, has lynx, terminal = lynx -- "$@"

#-------------------------------
# Text editors / pager
#-------------------------------
mime ^text, label editor = ${VISUAL:-$EDITOR} -- "$@"
mime ^text, label pager  = "$PAGER" -- "$@"
!mime ^text, label editor, ext py|sh|rb|pl|js|php|tex = ${VISUAL:-$EDITOR} -- "$@"
!mime ^text, label pager, ext py|sh|rb|pl|js|php|tex = "$PAGER" -- "$@"

#-------------------------------
# Scripts
#-------------------------------
ext py  = python -- "$1"
ext pl  = perl -- "$1"
ext rb  = ruby -- "$1"
ext js  = node -- "$1"
ext sh  = sh -- "$1"
ext php = php -- "$1"

#-------------------------------
# Audio (terminal)
#-------------------------------
mime ^audio, terminal, has mpv      = mpv -- "$@"
mime ^audio, terminal, has mplayer  = mplayer -- "$@"
mime ^audio, terminal, has mplayer2 = mplayer2 -- "$@"

#-------------------------------
# Video / Audio (GUI)
#-------------------------------
mime ^video|audio, has mpv, X, flag f      = mpv -- "$@"
mime ^video|audio, has mplayer, X, flag f  = mplayer -- "$@"
mime ^video|audio, has vlc, X, flag f      = vlc -- "$@"
mime ^video|audio, has smplayer, X, flag f = smplayer "$@"

#-------------------------------
# Documents
#-------------------------------
ext pdf, has zathura, X, flag f = zathura -- "$@"
ext pdf, has evince, X, flag f  = evince -- "$@"
ext pdf, has mupdf, X, flag f   = mupdf "$@"
ext djvu, has zathura, X, flag f = zathura -- "$@"
ext epub, has ebook-viewer, X, flag f = ebook-viewer -- "$@"
ext mobi, has ebook-viewer, X, flag f = ebook-viewer -- "$@"

# Office
ext docx?|xlsx?|pptx?|od[fpgst]|sxc|gnumeric, has libreoffice, X, flag f = libreoffice "$@"

#-------------------------------
# Images
#-------------------------------
mime ^image, has feh, X, flag f = feh -- "$@"
mime ^image, has sxiv, X, flag f = sxiv -- "$@"
mime ^image, has imv, X, flag f = imv -- "$@"

#-------------------------------
# Archives
#-------------------------------
ext 7z, has 7z = 7z x "$1"
ext zip, has unzip = unzip "$1"
ext tar, has tar = tar -xf "$1"
ext gz, has tar = tar -xzf "$1"
ext bz2, has tar = tar -xjf "$1"
ext xz, has tar = tar -xJf "$1"

# Optional: atool fallback
ext 7z|zip|tar|gz|bz2|xz, has atool = atool --extract --each -- "$@"
#-------------------------------
# Fonts
#-------------------------------
mime ^font, has fontforge, X, flag f = fontforge "$@"

#-------------------------------
# Terminal fallback (flag t)
#-------------------------------
mime ^ranger/x-terminal-emulator, has alacritty = alacritty -e "$@"
mime ^ranger/x-terminal-emulator, has kitty    = kitty -- "$@"
mime ^ranger/x-terminal-emulator, has xterm    = xterm -e "$@"
mime ^ranger/x-terminal-emulator, has gnome-terminal = gnome-terminal -- "$@"

#-------------------------------
# Wallpaper
#-------------------------------
label wallpaper, number 11, mime ^image, has feh, X = feh --bg-scale "$1"
label wallpaper, number 12, mime ^image, has feh, X = feh --bg-tile "$1"
label wallpaper, number 13, mime ^image, has feh, X = feh --bg-center "$1"
label wallpaper, number 14, mime ^image, has feh, X = feh --bg-fill "$1"

#-------------------------------
# Generic opener
#-------------------------------
label open, has xdg-open = xdg-open "$@"
label open, has open     = open -- "$@"

#-------------------------------
# Trash
#-------------------------------
label trash, has trash-put = trash-put -- "$@"
label trash = mkdir -p -- ${XDG_DATA_DIR:-$HOME/.ranger}/ranger-trash; mv -- "$@" ${XDG_DATA_DIR:-$HOME/.ranger}/ranger-trash

#-------------------------------
# Fallback for unknown files
#-------------------------------
!mime ^text, !ext py|sh|rb|pl|js|php|tex = ask
label editor, !mime ^text, !ext py|sh|rb|pl|js|php|tex = ${VISUAL:-$EDITOR} -- "$@"
label pager,  !mime ^text, !ext py|sh|rb|pl|js|php|tex = "$PAGER" -- "$@"
